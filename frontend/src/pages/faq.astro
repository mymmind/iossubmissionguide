---
import Layout from '../layouts/Layout.astro';

// All FAQs aggregated from article pages
const allFaqs = [
  {
    category: "App Store Rejections",
    questions: [
      {
        question: "What are the most common App Store rejection reasons?",
        answer: "The most common rejection reasons are: 1) Crashes and bugs (30%), 2) Broken links or placeholder content, 3) Missing privacy policy, 4) Guideline 4.2 minimum functionality, 5) Guideline 2.1 performance issues, 6) Missing demo account credentials, 7) Inaccurate metadata or screenshots.",
        link: "/rejection-guide"
      },
      {
        question: "What percentage of apps get rejected on first submission?",
        answer: "According to Apple, roughly 40-50% of first-time submissions get rejected. However, 90% of submissions are reviewed within 24 hours, and most rejections can be resolved and resubmitted quickly.",
        link: "/rejection-guide"
      },
      {
        question: "How can I avoid App Store rejection?",
        answer: "To avoid rejection: 1) Test thoroughly on real devices, 2) Include a working privacy policy URL, 3) Provide demo login credentials if needed, 4) Ensure all features work completely, 5) Follow Apple's Human Interface Guidelines, 6) Review the App Store Review Guidelines before submission.",
        link: "/rejection-guide"
      },
      {
        question: "What should I do after my app is rejected?",
        answer: "After rejection: 1) Read the rejection message carefully to understand the specific issue, 2) Check Resolution Center in App Store Connect for details, 3) Fix the identified issues, 4) Add detailed reviewer notes explaining your changes, 5) Resubmit through App Store Connect.",
        link: "/rejection-recovery"
      },
      {
        question: "Can I appeal an App Store rejection?",
        answer: "Yes, you can appeal through the App Review Board if you believe the rejection was incorrect. Use the Appeal button in Resolution Center. Provide clear evidence and reasoning. Appeals are reviewed by a different team and typically take 1-2 business days.",
        link: "/rejection-recovery"
      },
      {
        question: "How do I communicate with App Review?",
        answer: "Use the Resolution Center in App Store Connect to reply to rejections. Be professional and specific. You can ask clarifying questions, provide additional context, or explain why you believe the rejection was incorrect. Response times are usually within 24-48 hours.",
        link: "/rejection-recovery"
      }
    ]
  },
  {
    category: "Guideline 2.1: Crashes & Bugs",
    questions: [
      {
        question: "What is Guideline 2.1 rejection?",
        answer: "Guideline 2.1 rejection occurs when Apple's review team finds that your app crashes, has bugs, or doesn't perform as expected during testing. This includes crashes on launch, freezes, broken features, or performance issues.",
        link: "/guideline-2-1-app-crashes"
      },
      {
        question: "How do I fix a Guideline 2.1 rejection?",
        answer: "To fix a 2.1 rejection: 1) Reproduce the crash using the exact device and iOS version mentioned by Apple, 2) Check crash logs in Xcode Organizer, 3) Test thoroughly on real devices, 4) Ensure all features work offline/online, 5) Fix memory leaks and optimize performance, then resubmit.",
        link: "/guideline-2-1-app-crashes"
      },
      {
        question: "How long does it take to get approved after fixing crashes?",
        answer: "After fixing crashes and resubmitting, Apple typically reviews your app within 24-48 hours. Expedited reviews are available for critical bug fixes. Include detailed notes explaining what you fixed.",
        link: "/guideline-2-1-app-crashes"
      }
    ]
  },
  {
    category: "Guideline 3.1: In-App Purchases",
    questions: [
      {
        question: "What is Guideline 3.1 rejection?",
        answer: "Guideline 3.1 rejection happens when your app offers digital goods or services that must be purchased through Apple's In-App Purchase system but uses external payment methods instead, or when IAP implementation is incorrect.",
        link: "/guideline-3-1-in-app-purchase"
      },
      {
        question: "What purchases require Apple's In-App Purchase?",
        answer: "Digital content (ebooks, music, videos), subscriptions to digital services, premium features, virtual currency, and unlocking app functionality all require In-App Purchase. Physical goods, real-world services, and person-to-person services are exempt.",
        link: "/guideline-3-1-in-app-purchase"
      },
      {
        question: "How do I fix a Guideline 3.1 rejection?",
        answer: "To fix 3.1: 1) Remove external payment links for digital goods, 2) Implement StoreKit for all digital purchases, 3) Use the correct IAP product types, 4) Restore purchases functionality must work, 5) Don't mention external payment options in the app.",
        link: "/guideline-3-1-in-app-purchase"
      }
    ]
  },
  {
    category: "Guideline 4.2: Minimum Functionality",
    questions: [
      {
        question: "What is Guideline 4.2 rejection?",
        answer: "Guideline 4.2 rejection occurs when Apple determines your app doesn't provide enough features, functionality, or content to be considered a standalone app. This often affects simple wrapper apps, basic utilities, or apps that could be websites.",
        link: "/guideline-4-2-minimum-functionality"
      },
      {
        question: "How do I fix a Guideline 4.2 minimum functionality rejection?",
        answer: "To fix 4.2: 1) Add native iOS features (widgets, notifications, Siri shortcuts), 2) Implement offline functionality, 3) Add unique value beyond a website, 4) Include personalization features, 5) Use device capabilities (camera, sensors, haptics).",
        link: "/guideline-4-2-minimum-functionality"
      },
      {
        question: "Can a simple app get approved on the App Store?",
        answer: "Yes, simple apps can be approved if they provide genuine utility and use native iOS capabilities. Focus on doing one thing excellently rather than adding unnecessary features. Apps should offer value that justifies installation over using a website.",
        link: "/guideline-4-2-minimum-functionality"
      }
    ]
  },
  {
    category: "App Store Review Times",
    questions: [
      {
        question: "How long does App Store review take in 2025?",
        answer: "According to Apple, 90% of app submissions are reviewed within 24 hours. Most apps are reviewed within 24-48 hours. Complex apps or those requiring additional review may take longer. First-time submissions sometimes take slightly longer than updates.",
        link: "/app-store-review-time-2025"
      },
      {
        question: "Can I request an expedited App Store review?",
        answer: "Yes, you can request an expedited review through App Store Connect for critical bug fixes, security issues, or time-sensitive events. Apple reviews these requests case-by-case. Include a clear explanation of why the expedite is needed.",
        link: "/app-store-review-time-2025"
      },
      {
        question: "Why is my App Store review taking so long?",
        answer: "Extended review times can occur due to: 1) Complex app features requiring additional scrutiny, 2) Potential guideline violations needing manual review, 3) Holiday periods with higher submission volumes, 4) Apps in sensitive categories (health, finance, kids). Contact Apple through Resolution Center if review exceeds 5 business days.",
        link: "/app-store-review-time-2025"
      }
    ]
  },
  {
    category: "Privacy Policy Requirements",
    questions: [
      {
        question: "Do I need a privacy policy for my iOS app?",
        answer: "Yes, all apps on the App Store require a privacy policy. This is mandatory under Guideline 5.1.1 regardless of whether your app collects user data. The privacy policy must be accessible via a public URL and linked in App Store Connect.",
        link: "/app-store-privacy-policy-requirements"
      },
      {
        question: "What must be included in an App Store privacy policy?",
        answer: "Your privacy policy must include: 1) What data you collect, 2) How data is used, 3) Third-party services that receive data, 4) Data retention periods, 5) User rights regarding their data, 6) Contact information. It must match your App Privacy nutrition labels in App Store Connect.",
        link: "/app-store-privacy-policy-requirements"
      },
      {
        question: "Where do I add my privacy policy URL in App Store Connect?",
        answer: "Add your privacy policy URL in App Store Connect under App Information > Privacy Policy URL. The URL must be publicly accessible without login. You can also add it to your app's Settings screen for in-app access.",
        link: "/app-store-privacy-policy-requirements"
      }
    ]
  },
  {
    category: "React Native Submission",
    questions: [
      {
        question: "How do I submit a React Native app to the App Store?",
        answer: "To submit a React Native app: 1) Build with EAS Build or locally using Xcode, 2) Configure app.json/app.config.js with correct bundle ID and version, 3) Generate iOS build with proper signing, 4) Upload via Xcode or Transporter, 5) Complete App Store Connect metadata, 6) Submit for review.",
        link: "/react-native-app-store-submission"
      },
      {
        question: "Do React Native apps get rejected more often?",
        answer: "React Native apps are not rejected more often if built correctly. Common issues specific to React Native include: JavaScript bundle not loading, missing native permissions in Info.plist, and Hermes-related crashes. Test thoroughly on real devices before submission.",
        link: "/react-native-app-store-submission"
      },
      {
        question: "Should I use Expo or bare React Native for App Store submission?",
        answer: "Both work well for App Store submission. Expo with EAS Build simplifies the process with managed signing and building. Bare React Native gives more control but requires manual Xcode configuration. Choose based on your app's native module requirements.",
        link: "/react-native-app-store-submission"
      }
    ]
  },
  {
    category: "App Store Connect & TestFlight",
    questions: [
      {
        question: "How do I create an app in App Store Connect?",
        answer: "To create an app: 1) Log into App Store Connect, 2) Click My Apps > + > New App, 3) Select iOS platform, 4) Enter app name and primary language, 5) Choose a Bundle ID (must match Xcode), 6) Create a unique SKU, 7) Select user access level.",
        link: "/connect-guide"
      },
      {
        question: "What is TestFlight and how do I use it?",
        answer: "TestFlight is Apple's beta testing platform. Upload a build to App Store Connect, then: 1) Add internal testers (up to 100, instant access), 2) Create external testing groups (up to 10,000 testers, requires Beta App Review), 3) Share invite links or add testers by email. Builds expire after 90 days.",
        link: "/connect-guide"
      },
      {
        question: "How do I upload an app build to App Store Connect?",
        answer: "You can upload builds via: 1) Xcode: Product > Archive > Distribute App > App Store Connect, 2) Transporter app: Upload .ipa files directly, 3) altool command line: xcrun altool --upload-app. All methods require valid App Store Connect credentials and signing certificates.",
        link: "/connect-guide"
      }
    ]
  }
];

// Flatten all FAQs for schema
const allFaqsFlat = allFaqs.flatMap(cat => cat.questions);

// FAQ Schema for the page
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": allFaqsFlat.map(faq => ({
    "@type": "Question",
    "name": faq.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": faq.answer
    }
  }))
};

// Breadcrumb schema
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://iossubmissionguide.com"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "FAQ",
      "item": "https://iossubmissionguide.com/faq"
    }
  ]
};
---

<Layout
  title="App Store FAQ - Common Questions About iOS App Submission"
  description="Frequently asked questions about submitting apps to the Apple App Store. Get answers about rejections, review times, guidelines, and how to fix common issues."
>
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />

  <!-- Breadcrumb Navigation -->
  <nav class="mb-8" aria-label="Breadcrumb">
    <ol class="flex items-center gap-2 text-sm text-gray-500">
      <li>
        <a href="/" class="hover:text-apple-blue transition-colors">Home</a>
      </li>
      <li class="flex items-center gap-2">
        <svg class="w-4 h-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
        <span class="text-apple-dark font-medium">FAQ</span>
      </li>
    </ol>
  </nav>

  <article class="prose prose-lg max-w-none">
    <h1 class="text-4xl font-bold text-apple-dark mb-4">App Store Submission FAQ</h1>
    <p class="text-xl text-apple-gray mb-12">
      Find answers to the most common questions about submitting apps to the Apple App Store,
      handling rejections, and navigating the review process.
    </p>

    <!-- Quick Navigation -->
    <nav class="bg-apple-light rounded-2xl p-6 mb-12" aria-label="FAQ Categories">
      <h2 class="text-lg font-bold text-apple-dark mb-4">Jump to Category</h2>
      <div class="flex flex-wrap gap-2">
        {allFaqs.map((category, index) => (
          <a
            href={`#category-${index}`}
            class="px-4 py-2 bg-white rounded-full text-sm font-medium text-apple-blue hover:bg-apple-blue hover:text-white transition-colors border border-gray-200"
          >
            {category.category}
          </a>
        ))}
      </div>
    </nav>

    <!-- FAQ Sections -->
    {allFaqs.map((category, categoryIndex) => (
      <section id={`category-${categoryIndex}`} class="mb-16">
        <h2 class="text-2xl font-bold text-apple-dark mb-6 pb-3 border-b border-gray-200">
          {category.category}
        </h2>
        <div class="space-y-6">
          {category.questions.map((faq) => (
            <div class="bg-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-shadow">
              <h3 class="text-lg font-bold text-apple-dark mb-3">{faq.question}</h3>
              <p class="text-apple-gray leading-relaxed mb-4">{faq.answer}</p>
              <a
                href={faq.link}
                class="inline-flex items-center text-sm font-medium text-apple-blue hover:underline"
              >
                Read full guide
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </a>
            </div>
          ))}
        </div>
      </section>
    ))}

    <!-- CTA Section -->
    <section class="bg-gradient-to-br from-apple-blue to-blue-700 rounded-2xl p-8 text-white text-center mt-16">
      <h2 class="text-2xl font-bold mb-4">Still Have Questions?</h2>
      <p class="text-blue-100 mb-6 max-w-2xl mx-auto">
        Get personalized help with our AI Review Toolkit. It includes strategy guides,
        coding best practices, and LLM prompts to audit your codebase before submission.
      </p>
      <a
        href="/ai-review"
        class="inline-block bg-white text-apple-blue font-bold px-8 py-3 rounded-full hover:bg-blue-50 transition-colors"
      >
        Get the AI Toolkit
      </a>
    </section>
  </article>
</Layout>
